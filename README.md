# QBot_Jiemeng
使用 lagrange 作为后端，使用C++开发的QQ聊天机器人程序

- 本说明适用于v24.10，正在做迁移至lagrange的适配。故功能不全。
- 项目主要用于个人开发练习。
- 本说明用于介绍桔梦基本功能，组成，并帮助您快速上手。
- 具体的详细说明请参照进阶说明。

## 简介
桔梦(QBot_Jiemeng)是一个使用 lagrange 来达到QQ聊天功能的机器人程序。

## 已实现的特色应用场景举例

1. 定时消息
2. 远程指令执行
3. 可简易配置的第三方api调用
4. 用于 [Dice!](https://github.com/Dice-Developer-Team/Dice) 的牌堆调用兼容
5. 群聊检测到满足条件的信息向 bot 主或特定群聊上报消息。


## 特色

### 词库配置为中心

#### “一切皆消息”

将所有的事件都转换为文本消息来处理，以“收到消息——词库检索——执行应答”的流程处理所有事件。

#### 检索条件：使用正则表达式，

- 为了简化复杂的匹配逻辑用正则表达的困难与难以阅读，利用 json 数组的结构特点简化了表达

#### 较复杂的应答选取逻辑

- 提供了可调控概率的应答随机选取方法。
- 树状逻辑的应答库嵌套，即一个应答可以是若干的应答的组合，可实现更丰富的应答。
- 例如你预想的应答可分为3个部分，使用桔梦你可以很轻松的使你的随机输出可包括例如`A` `B1` `C2d` `3a` `Cb` 等等任意组合。

#### 一切操作皆可为应答

不论是发送消息，还是执行什么指令，都可以在应答里实现。简单的如执行shell指令，复杂的你甚至可以调用 api ,并根据 json 结果定制输出。



## ~~开发者的一些废话~~
~~非计算机相关专业，纯业余开发，技术稀烂，代码可读性极差，总之图一乐~~

## 系统需求

Windows 64位 / Linux

## 构建

仅提供 Linux 编译方案：  
环境条件：确保安装boost库，curl 库，nlohmann json库，以及安装了 g++。(测试了12/13版本)   
例如 `Arch Linux` 下：
```
pacman -S boost nlohmann-json
# curl gcc 一般已预装，故不列出。
```
执行`./build.sh`可在`build`目录下构建基础的工作文件夹。

## 运行依赖

- boost
- lagrange
- python(可选)
- python-pillow(可选) 用于txt2img功能支持
- ...



## 使用说明


### 下载

1. 下载新版桔梦release
2. ~~按release中说明下载并配置[go-cqhttp](https://github.com/Mrs4s/go-cqhttp)~~ 配置安装 lagrange

### 快速开始

1. 修改 `config.json`
   1. 将 `Self_ID` 字段的值改为 bot qq 号
   2. 在 `group_list` 中添加你想启用 bot 功能的群聊
   3. 将 `admin_list` 中 100 前的数字改为 bot 主的 QQ 号
2. 





### 文本内容常见替换
出于一些操作需求，一些特殊的字符串将会在输出前被替换成其他内容。部分如下：
- [poke]
	- 单独写成一条回复，表明发送一条戳一戳（头像双击）
- [name]
	- 替换为发信息者的群名片/昵称

### 开始使用：
- 请确保已完成所有配置
- ~~将Jiemeng的全部文件内容放到和go-cqhttp同一文件夹下，运行start.exe即可~~
- 分别启动 lagrange 与 桔梦。


---

## 已知问题

1. 各附加功能尚未完全支持
2. `aarch64` 环境下存在消息发送失败后程序崩溃退出的问题。未在 `x86_64` 环境下观察到。

